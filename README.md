一、需求细化
1. 核心目标
- 高效捕获单词：在用户浏览任意网页时，快速捕捉并识别生疏单词，支持复制、右键菜单自动捕捉等方式。
- 图像化记忆：利用 AI 生成“生动的场景描述”与对应图像，借助多维信息（如颜色、场景、人物活动等）帮助加深记忆。
- 内容沉淀与复盘：一键提交单词、文字描述和图像到 Flomo，便于后续复习和管理。
2. 主要功能模块
- 单词捕获
  - 用户手动输入、复制或通过右键菜单触发捕获。
  - 通过内容脚本监控选中或复制的文本，并传递到插件后台。
- 图像化描述生成
  - 调用 deepseek API，根据单词含义、词性、上下文（例句、短语）生成简短而生动的场景描述。
  - 生成描述时需整合多维度信息，便于后续图像生成时构建清晰画面。
- 图像生成
  - 调用 deepseek API，根据单词含义、词性、上下文（例句、短语）生成简短而生动的场景描述。
  - 生成描述时需整合多维度信息，便于后续图像生成时构建清晰画面。
- 图像生成
  - 调用第三方图像生成接口（如智谱 GLM API）使用生成的场景描述，返回对应的图片（支持缩略图显示）。
  - 图像生成过程中注意图片的返回格式（如 URL、Base64）以及加载和展示效率。
- Flomo 提交
  - 利用 Flomo 官方 API，将单词、图像化场景描述及图片一并提交。
  - 自动附加标签（如「#图像化单词记忆」），方便后续在 Flomo 内部进行归类管理。
  - 支持用户自定义标签，用户可以输入标签，插件会自动提交到API附加到卡片上。

- 历史记录与配置管理
  - 提供插件内历史记录查看功能，展示近期添加的单词及其图像化场景。
  - 存储用户的 Flomo API Token 和其他个性化配置（如接口选择、请求超时设置等），保证数据在本地安全存储。

二、技术架构设计

1.Chrome 插件前端架构

Manifest v3 架构

- 背景脚本（background service worker）：负责统一管理 API 调用、处理单词捕获后的数据流转、管理网络请求以及跨域通信。
- 内容脚本（content scripts）：嵌入到任意网页中，用于捕捉用户选中的单词、监控复制事件，并与背景脚本进行消息传递。
- 弹窗页面（popup 页面）：作为用户交互界面，展示查询到的单词解释、生成的图像化描述、AI 生成的图片，并提供“提交到 Flomo”、“收藏”等按钮。

UI 与交互
- 弹窗式设计，用户点击插件图标或使用右键菜单即可调起操作界面。
- 界面上需分区展示：单词基本信息、生成的场景描述、图像展示区以及操作按钮区。

存储方案

- 使用 chrome.storage（local 或 sync）存储用户的 Flomo Token  API 配置和样式配置。


2. 后端 API 对接

图像化描述生成

- API 调用：向 deepseek 发起请求，传递包含单词、上下文等信息的提示词。
- 参数设计：提示词需要确保包含足够信息（如单词含义、例句等），以便生成直观且富有画面感的描述。
- 返回处理：解析返回的描述文本，并传递至后续图像生成模块。

图像生成

- API 调用：调用第三方图像生成接口（如智谱 GLM API），使用上一步生成的场景描述作为输入。
- 数据格式：确保接口返回的图片数据可以直接在 popup 中展示（如图片 URL 或 Base64 数据）。

Flomo API 提交

- 接口调用：根据 Flomo 的 API 文档，通过 POST 请求提交数据，内容包括单词、场景描述及图片信息。
- 安全认证：使用用户预先配置的 Flomo API Token，保证提交过程安全、授权合规。
- 错误处理：设计失败重试及错误提示机制，确保提交失败时用户可以知晓并手动干预。
3. 数据与通信流程
单词捕获
- 用户在网页上选中或复制单词 → 内容脚本捕捉 → 发送消息至背景脚本

描述生成与图像生成
- 背景脚本接收单词信息 → 调用图像化描述生成 API → 获取场景描述
- 将场景描述作为输入调用图像生成 API → 获取图片数据

用户展示与操作
- 背景脚本将单词、描述、图片数据传给 popup 页面
- 用户在 popup 页面确认后，点击“提交到 Flomo”按钮

Flomo 提交与历史记录
- 背景脚本调用 Flomo API 将数据提交
同时更新 chrome.storage 中的历史记录，便于后续查询
4. 网络请求与安全
- 跨域请求：确保在 manifest.json 中配置相应的权限，允许插件访问 deepseek、图像生成、Flomo 等接口。
- 数据安全：用户的 API Token 需要加密或以安全方式存储，防止泄漏；

三、技术栈与实现路径
1. 前端技术
- 开发语言与框架：原生 JavaScript + HTML + CSS
- Manifest v3：背景脚本、内容脚本、弹窗页面等均依照最新标准开发
2. API 集成
- 文本生成：对接 deepseek API（需明确接口参数、调用频率、错误处理）
- 图像生成：对接智谱 GLM API（确定请求参数、返回格式、加载展示机制）
- Flomo API：调用 Flomo 提交接口，注意数据格式与授权机制
3. 插件存储
- 配置与历史记录存储：使用 chrome.storage API 存储用户的配置数据和提交历史
- 数据同步与备份：可考虑使用 chrome.storage.sync 实现多设备数据同步（视用户需求决定）
4. 测试与调试
- 单元测试与集成测试：为每个功能模块（单词捕获、描述生成、图像生成、Flomo 提交）设计测试用例
- 用户体验测试：在实际网页中测试内容脚本的兼容性及 popup 界面的响应速度
